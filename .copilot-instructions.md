# Copilot Development Instructions

## ðŸš¨ PRIME DIRECTIVE ðŸš¨
**CRITICAL RULE: AI MAY NEVER CREATE CODE WITHOUT EXPLICIT PERMISSION**

The AI assistant must NEVER write, create, modify, or generate any code whatsoever without the user's explicit permission for that specific action. This includes:
- Creating new files
- Modifying existing files  
- Writing code snippets
- Making any code changes

**The AI must always ask for permission before taking any coding action.**

**Violation of this directive is absolutely forbidden.**

---

## ARBETSSÃ„TT
- Du skriver ALL kod, jag granskar och styr riktning
- 100% TDD: Aldrig kod utan test fÃ¶rst (Red â†’ Green â†’ Refactor)
- Microscopic commits: Ett test, en implementation, eller en refactor per commit
- Trunk-based: Allt direkt till main, commit efter varje grÃ¶n test
- Extremt modulÃ¤r: varje feature egen package med egna tester
- VIKTIGT: Stanna upp efter varje TDD-cykel, commit, och pipeline-kÃ¶rning fÃ¶r feedback
- OBLIGATORISKT: Kontrollera att pipeline-resultatet Ã¤r grÃ¶na innan nÃ¤sta TDD-cykel
- AI-AGENTEN SKA ALLTID SJÃ„LV Ã–VERVAKA PIPELINE-STATUS OCH INTE GÃ… VIDARE TILL NÃ„STA STEG ELLER COMMIT FÃ–RRÃ„N PIPELINE Ã„R GRÃ–N.

### PIPELINE-CHECKING VERKTYG
- AnvÃ¤nd `./dev.sh` fÃ¶r utvecklarkonsolen (rekommenderas) 
- AnvÃ¤nd `./check_pipeline.sh` i terminal (Ã¤ven `--mock` fÃ¶r testlÃ¤ge)
- AnvÃ¤nd `./pipeline-status.sh` fÃ¶r kontinuerlig Ã¶vervakning
- AnvÃ¤nd VS Code task via kommandopalett:
  - `Check Pipeline Status`
  - `Check Pipeline Status (Mock)`
  - `Open Pipeline in Browser`
- Installera och anvÃ¤nd VS Code status bar extension
- Git pre-commit hook fÃ¶rhindrar GREEN/REFACTOR commits om pipeline inte Ã¤r grÃ¶n

## ARKITEKTUR - Hexagonal med file-sync
packages/
â”œâ”€â”€ domain/                    # Entities, Value Objects (Todo, User)
â”œâ”€â”€ application/               # Use Cases med dependency injection  
â”œâ”€â”€ infrastructure/            # File repositories, encryption, watchers
â”œâ”€â”€ shared/interfaces/         # Platform-agnostic contracts
â”œâ”€â”€ platform/node/             # macOS file system implementation
â”œâ”€â”€ platform/web/              # Browser file API implementation
â””â”€â”€ ui-web/                    # React components

## STORAGE STRATEGI
- JSON-filer i ~/Synology Drive/TodoApp/ (ALDRIG API-calls)
- File watchers detekterar Ã¤ndringar frÃ¥n andra enheter
- Offline-first, sync automatiskt nÃ¤r hemma pÃ¥ nÃ¤tverk
- Encryption-ready interfaces frÃ¥n bÃ¶rjan

## FRAMTIDSSÃ„KRING
- Samma business logic fÃ¶r web â†’ electron â†’ iOS
- Event-driven design fÃ¶r real-time sync senare
- Platform-agnostic interfaces (FileSystem, Repository)
- Dependency injection fÃ¶r att swappa implementationer
- Zero coupling mellan features via events

## CI/CD KRAV
- GitHub Actions validerar VARJE commit
- Test levels: unit â†’ integration â†’ E2E â†’ performance
- Coverage threshold: 100% (build fails annars)
- Quality gates: TypeScript strict, ESLint, Prettier
- Performance targets: <50ms file ops, <100ms encryption, <1s UI
- .github/workflows/ setup required

## TDD REGLER
1. Skriv test fÃ¶rst (Red)
2. Minimal implementation (Green)
3. Refaktorera (Refactor)
4. Commit varje steg separat
5. FrÃ¥ga innan antaganden
6. Bygg bara det testet krÃ¤ver
7. Stanna fÃ¶r feedback efter varje TDD-cykel
8. Kontrollera alltid att CI/CD pipeline Ã¤r grÃ¶n innan nÃ¤sta cykel

## FÃ–RBJUDET
- Kod utan test fÃ¶rst
- API calls till NAS (anvÃ¤nd file-sync)
- Flera fÃ¶rÃ¤ndringar per commit
- HÃ¥rdkodade dependencies
- Shortcuts i arkitektur
- FortsÃ¤tta till nÃ¤sta TDD-cykel utan grÃ¶n pipeline
